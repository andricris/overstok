<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCM Dropping Optimizer (Rayonisasi)</title>
    
    <!-- 1. Tailwind CSS (Styling) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. React & ReactDOM (Core) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- 3. Babel (Agar browser bisa baca kode React JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- 4. SheetJS (Untuk baca Excel) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <style>
        body { background-color: #f3f4f6; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .spin { animation: spin 1s linear infinite; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- DATA RAYONISASI ---
        const ISLAND_MAPPING = {
            // JAWA & BALI
            'BDG': 'JAWA', 'JMR': 'JAWA', 'SLO': 'JAWA', 'YGY': 'JAWA',
            'SBY': 'JAWA', 'BKS': 'JAWA', 'SMG': 'JAWA', 'DPS': 'JAWA',
            'MLG': 'JAWA', 'JKT': 'JAWA', 'TGR': 'JAWA', 'CRB': 'JAWA',
            'PWT': 'JAWA', 'BGR': 'JAWA', 'JAK': 'JAWA', 'SRG': 'JAWA',
            
            // SUMATERA
            'PDG': 'SUMATERA', 'JBI': 'SUMATERA', 'PLB': 'SUMATERA',
            'PKB': 'SUMATERA', 'BLP': 'SUMATERA', 'BTM': 'SUMATERA',
            'MDN': 'SUMATERA', 'NAD': 'SUMATERA', 'ACE': 'SUMATERA',
            'PLM': 'SUMATERA',
            
            // CABANG JAUH
            'BJM': 'CABANG JAUH', 'PTK': 'CABANG JAUH', 'MDO': 'CABANG JAUH',
            'MKS': 'CABANG JAUH', 'SMD': 'CABANG JAUH', 'PNK': 'CABANG JAUH',
            'BPN': 'CABANG JAUH', 'PLU': 'CABANG JAUH', 'KDI': 'CABANG JAUH'
        };

        // --- ICONS (Inline SVG agar tidak perlu install library) ---
        const IconUpload = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>;
        const IconFile = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/></svg>;
        const IconArrowRight = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>;
        const IconSettings = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.39a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>;
        const IconCheck = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>;
        const IconDownload = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>;
        const IconSearch = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>;
        const IconPackage = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="16.5" y1="9.4" x2="7.5" y2="4.21"/><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>;
        const IconMapPin = () => <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>;
        const IconBox = () => <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>;
        const IconInfo = () => <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>;
        const IconLoading = () => <svg className="spin" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>;

        // --- HELPER FUNCTIONS ---
        const getColLetter = (colIndex) => {
            let temp, letter = '';
            while (colIndex >= 0) {
                temp = (colIndex) % 26;
                letter = String.fromCharCode(temp + 65) + letter;
                colIndex = (colIndex - temp - 1) / 26;
            }
            return letter;
        };

        const getColIndex = (letter) => {
            let column = 0;
            const length = letter.length;
            for (let i = 0; i < length; i++) {
                column += (letter.charCodeAt(i) - 64) * Math.pow(26, length - i - 1);
            }
            return column - 1;
        };

        const getIsland = (branchCode) => {
            if (!branchCode) return 'UNKNOWN';
            const cleanCode = String(branchCode).toUpperCase().replace(/[^A-Z]/g, '');
            const prefix3 = cleanCode.substring(0, 3);
            if (ISLAND_MAPPING[prefix3]) return ISLAND_MAPPING[prefix3];
            return 'OTHER';
        };

        const parseSmartNumber = (val) => {
            if (typeof val === 'number') return Math.floor(val);
            if (!val) return 0;
            const strVal = String(val).trim();
            if (strVal === '-' || strVal === '') return 0;
            let result = 0;
            if (strVal.includes(',') && !strVal.includes('.')) {
                result = parseFloat(strVal.replace(',', '.'));
            } else {
                result = parseFloat(strVal);
            }
            return Math.floor(result) || 0;
        };

        // --- MAIN APP COMPONENT ---
        const App = () => {
            const [step, setStep] = React.useState(1);
            const [workbook, setWorkbook] = React.useState(null);
            const [sheetName, setSheetName] = React.useState('');
            const [previewData, setPreviewData] = React.useState([]);
            const [headerRowIndex, setHeaderRowIndex] = React.useState(4);
            const [suggestions, setSuggestions] = React.useState([]);
            const [searchTerm, setSearchTerm] = React.useState('');
            
            // Konfigurasi Kolom
            const [colMapping, setColMapping] = React.useState({
                branch: 'A',
                productCode: 'E',
                productDesc: 'F',
                planDrop: 'AY',
                overStock: 'AZ',
                multiple: 'AP'
            });

            // STEP 1: Upload File
            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (evt) => {
                    try {
                        const bstr = evt.target.result;
                        const wb = XLSX.read(bstr, { type: 'binary' });
                        setWorkbook(wb);

                        if (!wb.SheetNames.length) { alert("Excel Kosong"); return; }
                        
                        const firstSheet = wb.SheetNames[0];
                        setSheetName(firstSheet);
                        const ws = wb.Sheets[firstSheet];
                        const data = XLSX.utils.sheet_to_json(ws, { header: 1, range: 0, defval: "" });
                        
                        setPreviewData(data.slice(0, 10));
                        setStep(2);
                    } catch (err) {
                        console.error(err);
                        alert("Gagal membaca file. Pastikan format .xlsx atau .csv");
                    }
                };
                reader.readAsBinaryString(file);
            };

            // STEP 2: Analisa Logic
            const handleAnalyze = () => {
                try {
                    const ws = workbook.Sheets[sheetName];
                    const rawData = XLSX.utils.sheet_to_json(ws, { header: 1, range: headerRowIndex + 1, defval: 0 });

                    const idx = {
                        branch: getColIndex(colMapping.branch.toUpperCase()),
                        code: getColIndex(colMapping.productCode.toUpperCase()),
                        desc: getColIndex(colMapping.productDesc.toUpperCase()),
                        need: getColIndex(colMapping.planDrop.toUpperCase()),
                        over: getColIndex(colMapping.overStock.toUpperCase()),
                        multiple: getColIndex(colMapping.multiple.toUpperCase()),
                    };

                    const productGroups = {};

                    rawData.forEach(row => {
                        if (!row || row.length <= idx.code) return;
                        const pCode = row[idx.code];
                        if (!pCode) return;

                        let multipleVal = parseSmartNumber(row[idx.multiple]);
                        if (multipleVal <= 0) multipleVal = 1;

                        if (!productGroups[pCode]) {
                            productGroups[pCode] = {
                                desc: row[idx.desc] || "Tanpa Nama",
                                multiple: multipleVal,
                                sources: [],
                                destinations: []
                            };
                        }

                        const branch = row[idx.branch] || "Unknown";
                        const island = getIsland(branch);
                        const overQty = parseSmartNumber(row[idx.over]);
                        const needQty = parseSmartNumber(row[idx.need]);

                        if (overQty > 0) productGroups[pCode].sources.push({ branch, island, qty: overQty });
                        if (needQty > 0) productGroups[pCode].destinations.push({ branch, island, qty: needQty });
                    });

                    const newSuggestions = [];

                    Object.keys(productGroups).forEach(code => {
                        const group = productGroups[code];
                        const K = group.multiple;

                        // Sort Destinasi (Kebutuhan Terbesar)
                        group.destinations.sort((a, b) => b.qty - a.qty);

                        group.destinations.forEach(dest => {
                            let remainingNeed = dest.qty;

                            // Sort Sumber (Prioritas Rayon)
                            group.sources.sort((a, b) => {
                                const sameA = a.island === dest.island;
                                const sameB = b.island === dest.island;
                                if (sameA && !sameB) return -1;
                                if (!sameA && sameB) return 1;
                                return b.qty - a.qty;
                            });

                            for (let i = 0; i < group.sources.length; i++) {
                                const source = group.sources[i];
                                if (source.qty <= 0 || remainingNeed <= 0) continue;

                                const maxPotential = Math.min(remainingNeed, source.qty);
                                const validTransfer = Math.floor(maxPotential / K) * K;

                                if (validTransfer === 0) continue;

                                const isSameIsland = source.island === dest.island;
                                const transferType = (isSameIsland && source.island !== 'UNKNOWN' && source.island !== 'OTHER') ? "LOCAL" : "INTER_ISLAND";

                                newSuggestions.push({
                                    id: Math.random().toString(36).substr(2, 9),
                                    productCode: code,
                                    productDesc: group.desc,
                                    multiple: K,
                                    from: source.branch,
                                    fromIsland: source.island,
                                    to: dest.branch,
                                    toIsland: dest.island,
                                    qty: validTransfer,
                                    transferType: transferType,
                                    sourceStockBefore: source.qty // Capture stock before update
                                });

                                source.qty -= validTransfer;
                                remainingNeed -= validTransfer;
                                if (remainingNeed < K) break;
                            }
                        });
                    });

                    setSuggestions(newSuggestions);
                    setStep(3);

                } catch (err) {
                    alert("Error saat analisa: " + err.message);
                }
            };

            // Download CSV
            const downloadCSV = () => {
                const headers = ["Kode Produk", "Deskripsi", "Tipe Transfer", "Dari Cabang", "Rayon Asal", "Overstok", "Ke Cabang", "Rayon Tujuan", "Kelipatan", "Qty Transfer"];
                const rows = suggestions.map(s => [
                    s.productCode, `"${s.productDesc || ''}"`,
                    s.transferType === 'LOCAL' ? 'SATU RAYON' : 'LUAR RAYON',
                    s.from, s.fromIsland,
                    s.sourceStockBefore, // Add stock info to CSV
                    s.to, s.toIsland,
                    s.multiple, s.qty
                ]);
                const csvContent = "data:text/csv;charset=utf-8," + headers.join(";") + "\n" + rows.map(e => e.join(";")).join("\n");
                const link = document.createElement("a");
                link.href = encodeURI(csvContent);
                link.download = "rekomendasi_dropping_final.csv";
                document.body.appendChild(link);
                link.click();
            };

            const filteredSuggestions = React.useMemo(() => {
                return suggestions.filter(item => 
                    item.productDesc?.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    item.productCode?.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    item.from?.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    item.to?.toLowerCase().includes(searchTerm.toLowerCase())
                );
            }, [suggestions, searchTerm]);

            // --- UI RENDERING ---
            return (
                <div className="max-w-7xl mx-auto px-4 py-8">
                    <div className="mb-8">
                        <h1 className="text-2xl font-bold text-gray-900">SCM Dropping Optimizer (Versi HTML)</h1>
                        <p className="text-gray-600 text-sm">Analisis Rayonisasi: Jawa, Sumatera, Cabang Jauh (Kalimantan/Sulawesi).</p>
                    </div>

                    {/* Progress Bar */}
                    <div className="flex gap-2 mb-6">
                        {[1, 2, 3].map(s => (
                            <div key={s} className={`h-2 flex-1 rounded-full ${step >= s ? 'bg-blue-600' : 'bg-gray-200'}`}></div>
                        ))}
                    </div>

                    {/* STEP 1: UPLOAD */}
                    {step === 1 && (
                        <div className="flex flex-col items-center justify-center p-12 border-2 border-dashed border-gray-300 rounded-xl bg-white hover:bg-gray-50 transition-colors cursor-pointer relative min-h-[300px]">
                            <input type="file" accept=".xlsx, .xls, .csv" onChange={handleFileUpload} className="absolute inset-0 w-full h-full opacity-0 cursor-pointer" />
                            <div className="text-green-600 mb-4"><IconFile /></div>
                            <h3 className="text-xl font-semibold text-gray-700">Upload File Excel</h3>
                            <p className="text-gray-500 mt-2 text-center">Tarik file ke sini atau klik untuk browse</p>
                        </div>
                    )}

                    {/* STEP 2: CONFIG */}
                    {step === 2 && (
                        <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                            <div className="flex justify-between items-center mb-6">
                                <h3 className="text-lg font-bold flex gap-2 items-center"><IconSettings /> Konfigurasi</h3>
                                <button onClick={handleAnalyze} className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium flex items-center gap-2">
                                    Mulai Analisa <IconArrowRight />
                                </button>
                            </div>
                            
                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                <div className="space-y-4">
                                    <div className="bg-blue-50 p-4 rounded border border-blue-100">
                                        <label className="block text-sm font-semibold mb-2">Baris Header</label>
                                        <input type="number" value={headerRowIndex + 1} onChange={(e) => setHeaderRowIndex(parseInt(e.target.value) - 1)} className="w-20 p-2 border rounded" />
                                    </div>
                                    
                                    <div className="grid grid-cols-2 gap-4">
                                        <div><label className="text-xs font-bold text-gray-500">CABANG (A)</label><input type="text" value={colMapping.branch} onChange={e=>setColMapping({...colMapping, branch:e.target.value})} className="w-full p-2 border rounded font-mono uppercase"/></div>
                                        <div><label className="text-xs font-bold text-gray-500">KODE (E)</label><input type="text" value={colMapping.productCode} onChange={e=>setColMapping({...colMapping, productCode:e.target.value})} className="w-full p-2 border rounded font-mono uppercase"/></div>
                                        <div className="col-span-2"><label className="text-xs font-bold text-gray-500">DESKRIPSI (F)</label><input type="text" value={colMapping.productDesc} onChange={e=>setColMapping({...colMapping, productDesc:e.target.value})} className="w-full p-2 border rounded font-mono uppercase"/></div>
                                        
                                        <div><label className="text-xs font-bold text-green-700">OVER (AZ)</label><input type="text" value={colMapping.overStock} onChange={e=>setColMapping({...colMapping, overStock:e.target.value})} className="w-full p-2 border-2 border-green-200 bg-green-50 rounded font-mono uppercase"/></div>
                                        <div><label className="text-xs font-bold text-red-700">BUTUH (AY)</label><input type="text" value={colMapping.planDrop} onChange={e=>setColMapping({...colMapping, planDrop:e.target.value})} className="w-full p-2 border-2 border-red-200 bg-red-50 rounded font-mono uppercase"/></div>
                                        <div className="col-span-2"><label className="text-xs font-bold text-purple-700">KELIPATAN (AP)</label><input type="text" value={colMapping.multiple} onChange={e=>setColMapping({...colMapping, multiple:e.target.value})} className="w-full p-2 border-2 border-purple-200 bg-purple-50 rounded font-mono uppercase"/></div>
                                    </div>
                                </div>

                                <div className="overflow-auto border rounded bg-gray-50 max-h-[400px]">
                                    <table className="w-full text-xs whitespace-nowrap">
                                        <thead>
                                            <tr>
                                                <th className="p-2 bg-gray-200 sticky top-0 border-b text-center">#</th>
                                                {previewData.length > 0 && previewData[0].map((_, i) => (
                                                    <th key={i} className={`p-2 sticky top-0 border-b text-center font-mono ${getColLetter(i) === colMapping.overStock ? 'bg-green-200' : getColLetter(i) === colMapping.planDrop ? 'bg-red-200' : 'bg-gray-200'}`}>
                                                        {getColLetter(i)}
                                                    </th>
                                                ))}
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {previewData.map((row, rIdx) => (
                                                <tr key={rIdx} className={rIdx === headerRowIndex ? 'bg-blue-100 font-bold' : ''}>
                                                    <td className="p-2 border-b text-center">{rIdx + 1}</td>
                                                    {row.map((cell, cIdx) => <td key={cIdx} className="p-2 border-b border-l truncate max-w-[100px]">{cell}</td>)}
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* STEP 3: RESULT */}
                    {step === 3 && (
                        <div className="space-y-6">
                            <div className="flex flex-col md:flex-row justify-between items-center gap-4">
                                <div><h3 className="text-xl font-bold">Hasil Analisa</h3><p className="text-sm text-gray-500">Total Saran: {suggestions.length}</p></div>
                                <div className="flex gap-2">
                                    <div className="relative">
                                        <div className="absolute left-3 top-2 text-gray-400"><IconSearch /></div>
                                        <input type="text" placeholder="Cari..." value={searchTerm} onChange={e => setSearchTerm(e.target.value)} className="pl-9 pr-4 py-2 border rounded-lg" />
                                    </div>
                                    <button onClick={downloadCSV} className="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2"><IconDownload /> CSV</button>
                                    <button onClick={() => { setStep(2); setSuggestions([]); }} className="bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded-lg text-sm">Ulangi</button>
                                </div>
                            </div>

                            <div className="bg-white rounded-xl shadow border overflow-hidden">
                                <div className="overflow-x-auto">
                                    <table className="w-full text-sm text-left">
                                        <thead className="text-xs text-gray-700 uppercase bg-gray-50 border-b">
                                            <tr>
                                                <th className="px-4 py-3">Produk</th>
                                                <th className="px-4 py-3 text-center">Tipe</th>
                                                <th className="px-4 py-3 bg-green-50">Sumber</th>
                                                <th className="px-2 py-3 text-center"></th>
                                                <th className="px-4 py-3 bg-red-50">Tujuan</th>
                                                <th className="px-4 py-3 text-right bg-blue-50">Qty</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y">
                                            {filteredSuggestions.map((item) => (
                                                <tr key={item.id} className="hover:bg-gray-50">
                                                    <td className="px-4 py-3">
                                                        <div className="font-bold text-gray-900 flex items-center gap-2"><IconPackage /> {item.productCode}</div>
                                                        <div className="text-xs text-gray-500 truncate max-w-[200px]" title={item.productDesc}>{item.productDesc}</div>
                                                    </td>
                                                    <td className="px-4 py-3 text-center">
                                                        <span className={`px-2 py-1 rounded-full text-[10px] font-bold border ${item.transferType === 'LOCAL' ? 'bg-green-100 text-green-700 border-green-200' : 'bg-yellow-100 text-yellow-700 border-yellow-200'}`}>
                                                            {item.transferType === 'LOCAL' ? 'SATU RAYON' : 'LUAR RAYON'}
                                                        </span>
                                                    </td>
                                                    <td className="px-4 py-3 bg-green-50/30 border-l">
                                                        <div className="font-medium text-green-800">{item.from}</div>
                                                        <div className="text-[10px] text-gray-500 flex items-center gap-1"><IconMapPin /> {item.fromIsland}</div>
                                                        <div className="text-[10px] text-green-600 font-semibold mt-1">Overstok: {item.sourceStockBefore}</div>
                                                    </td>
                                                    <td className="px-2 py-3 text-center text-gray-400"><IconArrowRight /></td>
                                                    <td className="px-4 py-3 bg-red-50/30 border-l">
                                                        <div className="font-medium text-red-800">{item.to}</div>
                                                        <div className="text-[10px] text-gray-500 flex items-center gap-1"><IconMapPin /> {item.toIsland}</div>
                                                    </td>
                                                    <td className="px-4 py-3 text-right font-bold text-blue-600 bg-blue-50/30">
                                                        {item.qty}
                                                        <div className="text-[10px] text-gray-400 font-normal">x{item.multiple} Pack</div>
                                                    </td>
                                                </tr>
                                            ))}
                                            {filteredSuggestions.length === 0 && (
                                                <tr><td colSpan="6" className="p-8 text-center text-gray-500"><IconInfo /><br/>Tidak ada data</td></tr>
                                            )}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
